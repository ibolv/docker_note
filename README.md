sudo apt update

sudo apt install apt-transport-https ca-certificates

curl -fssL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -

sudo apt install curl --- если не установлен

sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

sudo apt install docker-ce

sudo systemctl status docker

docker –v

sudo usermod -aG docker $USER



FROM ubuntu:latest В качестве базового образа будет использоваться latest версия
образа Ubuntu.
MAINTAINER
Справочная информация. Не обязательный параметр.
RUN apt-get update -y Обновить информацию о репозиториях внутри контейнера
RUN apt-get install -y python-pip
python-dev build-essential
Установить внутрь контейнера пакеты: python-pip, python-dev,
build-essential
COPY . /app
Скопировать содержимое текущей директории «.» в директорию
/app внутри образа. Внимание: текущей директорией в процессе
сборки будет считаться директория, содержащая Dockerfile, т.е. в
нашем случае my_flask_app/
WORKDIR /app
Сменить рабочую директорию внутри контейнера. Все команды
далее будут запускаться внутри директории /app внутри
контейнера
RUN pip install -r requirements.txt
Установить зависимости, сохраненные вами в requirements.txt.
Данная команда установить Flask и все, что необходимо для его
запуска внутри контейнера.
ENTRYPOINT [«python»] Запускать интерпретатор python по умолчанию
CMD [«app.py»]
В сочетании с использованием ENTRYPOINT интерпретатору
python будет передан дополнительный аргумент app.py. Другими
словами, во время запуска контейнера последней инструкцией
будет выполнена команда python app.py из директории /app




Для создания собственного контейнера, содержащего ваше простое Flask приложение, находясь внутри
директории my_project необходимо выполнить команду:
$ docker build -t my_flask_app:v0.1 my_flask_app/
Ключ -t предназначен для того, чтобы присвоить вашему образу метку (label) «my_flask_app» и его
версию «v0.1». Метка и версия могут быть произвольными. Если в качестве версии использовать
«latest», то собранный вами образ будет помечен как имеющий самую свежую версию.
В процессе выполнения команды как описано в вашем Dockerfile будет произведена загрузка последнего
образа ubuntu, внутри него установлены все необходимые зависимости, создана директория /app, в
которую будет помещено содержимое директории my_flask_app/, установлены все зависимости из файла
requirements.txt, а сам образ настроен на запуск вашего Flask приложения из директории /app,
находящейся внутри образа.


Для запуска Docker контейнера из подготовленного вами образа необходимо выполнить команду
$ docker run -d -p 5000:5000 my_flask_app:v0.1
Ключ -d предназначен для запуска вашего контейнера в фоновом режиме (необходим для того, чтобы
вернуть управление терминалу, в котором вы работаете).
Ключ -p заставит Docker Machine пробрасывать подключения, приходящие на порт 5000 внешнего
адреса Docker Machine на порт 5000 контейнера, на котором будет слушать подключения ваше Flask
приложение. Использование -p [порт на Docker Machine:порт контейнера].
Проверить, что контейнер успешно запущен можно командой
$ docker ps -a


Остановка запущенного контейнера выполняется командой
$ docker stop 5a166878f263
А для того, чтобы удалить запущенный контейнер, необходимо выполнить команду
$ docker rm 5a166878f263



docker-compose up -d
Ключ -d необходим, чтобы запустить ваше приложение, состоящее из одного контейнера, и вернуть
управление терминалу, в котором вы вызывали docker-compose

$ docker-compose build
А перезапуск контейнера вместе с предварительной пересборкой, выполняется командой

$ docker-compose up -d --build
Просмотр запущенных docker-compose контейнеров, а также информации по опубликованным ими
портам осуществляется командой
$ docker-compose ps


Остановка приложения выполняется командой
$ docker-compose stop
Stopping myproject_web_1 ... done
Одновременная остановка и удаление выполняются командой
$ docker-compose down
Stopping myproject_web_1 ... done
Removing myproject_web_1 ... done


web: Название компонента приложения, управляемого Docker Compose. Каждый
компонент запускается в отдельном контейнере или их группе
build: ./my_flask_app Обозначение того, что данный компонент будет запускаться из образа,
который необходимо собрать. Инструкции по сборке будут искаться в
Строка Описание
Dockerfile в директории ./my_flask_app относительно docker-compose.yml
файла
ports:
 - "5000:5000"
Обозначение того, что необходимо выполнить публикацию порта 5000
данного компонента в порт 5000, доступный по внешнему IP-адресу хоста
(или виртуальной машины), на котором будет запущено приложение.
volumes:
 - ./my_flask_app:/app
Обозначение того, что внутрь контейнера, отвечающего за данный
компонент приложения, необходимо подключить Docker диск (Docker
Volume). В данном случае в роли Docker диска будет
выступать директория ./my_flask_app, которая будет cмонтирована в
директорию /app внутрь контейнера. Эта операция выполнена для того,
чтобы можно было легко менять Flask приложение и наблюдать изменения
обновляя окно браузера, а не выполняя пересборку всего контейнера
целиком. Попробуйте изменить вывод функции hello_world в файле
./my_flask_app/app.py, чтобы в этом убедиться
